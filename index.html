<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Semakan Keputusan UASA - SK PULAU PERHENTIAN</title>
    
    <!-- Library untuk PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Arial:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #002366; /* Royal Dark Blue */
            --secondary-color: #004e92;
            --bg-color: #f4f7f6;
            --text-color: #333;
            --white: #ffffff;
        }

        body {
            font-family: 'Arial', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
            color: var(--text-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* HEADER - Dipermudah tanpa animasi */
        header {
            background-color: var(--primary-color);
            color: var(--white);
            padding: 15px 10px;
            text-align: center;
            border-bottom: 4px solid var(--secondary-color);
        }

        .header-content {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 15px;
            max-width: 600px;
            margin: 0 auto;
        }

        .logo {
            width: 60px; /* Saiz dikecilkan */
            height: auto;
            background: #fff;
            border-radius: 50%;
            padding: 2px;
            border: 2px solid #ddd;
        }

        .header-text {
            text-align: left;
        }

        h1 {
            margin: 0;
            font-size: 1.2rem;
            text-transform: uppercase;
            font-weight: 700;
        }

        h2 {
            margin: 2px 0 0;
            font-size: 0.9rem;
            font-weight: 400;
            color: #eee;
        }

        /* MAIN CONTAINER */
        .container {
            flex: 1;
            max-width: 600px;
            width: 95%;
            margin: 20px auto;
        }

        /* SEARCH CARD */
        .search-card {
            background: var(--white);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
            text-align: center;
        }

        .form-group {
            margin-bottom: 15px;
            text-align: left;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: var(--primary-color);
            font-size: 0.9rem;
        }

        .search-input {
            width: 100%;
            padding: 10px;
            font-size: 1rem;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
            -webkit-appearance: none;
        }

        .search-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 30px;
            font-size: 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-top: 10px;
        }

        .note {
            margin-top: 15px;
            font-size: 0.75rem;
            color: #666;
            font-style: italic;
        }

        /* RESULTS SECTION */
        #result-section {
            display: none;
            margin-top: 20px;
        }

        .student-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .student-card {
            background: white;
            border: 1px solid #ddd;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .st-info h3 {
            margin: 0 0 5px 0;
            color: var(--primary-color);
            font-size: 1rem;
        }

        .st-info p {
            margin: 3px 0;
            color: #444;
            font-size: 0.85rem;
        }

        .action-btn {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            text-align: center;
            width: 100%;
        }

        .no-result {
            text-align: center;
            color: #c0392b;
            font-weight: bold;
            background: #fadbd8;
            padding: 10px;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        /* FOOTER */
        footer {
            text-align: center;
            padding: 15px;
            color: #888;
            font-size: 0.75rem;
            margin-top: auto;
            border-top: 1px solid #eee;
            background: white;
        }

        /* 
           PDF STYLING (A4 - Hidden from view)
        */
        #slip-offscreen-area {
            position: fixed;
            top: 0;
            left: -10000px;
            z-index: -100;
        }

        #slip-container {
            width: 210mm;
            min-height: 296mm;
            padding: 15mm 15mm;
            background: white;
            color: black;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
            border: 1px solid #ccc;
            display: flex;
            flex-direction: column;
        }

        .slip-header-section {
            text-align: center;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .slip-header-section img {
            width: 80px;
            height: 80px;
        }

        .slip-title h2 { font-size: 16pt; margin: 0; text-transform: uppercase; color: #000; }
        .slip-title h3 { font-size: 12pt; margin: 5px 0 0 0; font-weight: normal; color: #000; }

        .student-table { width: 100%; border: none; margin-bottom: 15px; }
        .student-table td { padding: 5px 0; border: none; font-size: 11pt; color: #000; vertical-align: top;}
        .student-label { font-weight: bold; width: 130px; }
        .student-data { border-bottom: 1px dotted #999 !important; font-weight: bold; display: inline-block; width: 90%; }

        .marks-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .marks-table th, .marks-table td { border: 1px solid #000; padding: 6px; font-size: 10pt; text-align: center; color: #000; }
        .marks-table th { background-color: #e0e0e0; font-weight: bold; }
        .marks-table td:first-child { text-align: left; padding-left: 10px; }

        .summary-box { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 10pt; font-weight: bold; border: 1px solid #000; padding: 8px; background: #f9f9f9; }

        .footer-signatures { margin-top: 40px; display: flex; justify-content: space-between; padding: 0 20px; }
        .sig-block { text-align: center; width: 40%; }
        .sig-line { border-bottom: 1px solid #000; margin-bottom: 5px; height: 30px; }
        .sig-text { font-size: 10pt; }

        @media (min-width: 600px) {
            .student-card { flex-direction: row; justify-content: space-between; align-items: center; }
            .action-btn { width: auto; padding: 8px 20px; }
            .search-btn { width: auto; padding: 10px 40px; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-content">
            <!-- Logo dikecilkan & tiada shadow berat -->
            <img src="https://i.postimg.cc/sxchBct9/LOGO-SKPP.png" alt="Logo SKPP" class="logo" width="60" height="60">
            <div class="header-text">
                <h1>Analisis UASA 2025/2026</h1>
                <h2>SK PULAU PERHENTIAN</h2>
            </div>
        </div>
    </header>

    <div class="container">
        
        <div class="search-card">
            <h3 style="color:var(--primary-color); margin-top:0;">Semakan Ibu Bapa</h3>
            
            <div class="form-group">
                <label class="form-label">Masukkan Nama Anak</label>
                <input type="text" id="parent-input" class="search-input" placeholder="Cth: Ahmad..." onkeydown="if(event.key==='Enter') findStudent()">
            </div>

            <button class="search-btn" onclick="findStudent()">
                Semak
            </button>

            <div class="note">
                Sila gunakan carian Nama. Pastikan ejaan nama betul.
            </div>
        </div>

        <div id="result-section">
            <!-- Results will appear here -->
        </div>

    </div>

    <footer>
        &copy; 2025 SK Pulau Perhentian.
    </footer>

    <!-- PDF Template Area (Hidden) -->
    <div id="slip-offscreen-area">
        <div id="slip-container">
            <div class="slip-header-section">
                <!-- Logo untuk PDF -->
                <img src="https://i.postimg.cc/sxchBct9/LOGO-SKPP.png" alt="Logo" crossorigin="anonymous">
                <div class="slip-title">
                    <h2>SK PULAU PERHENTIAN</h2>
                    <h3>LAPORAN UJIAN AKHIR SESI AKADEMIK 2025/2026</h3>
                </div>
            </div>

            <table class="student-table">
                <tr><td class="student-label">NAMA MURID</td><td>: <span id="pdf-name" class="student-data"></span></td></tr>
                <tr><td class="student-label">KELAS</td><td>: <span id="pdf-class" class="student-data"></span></td></tr>
                <tr><td class="student-label">GURU KELAS</td><td>: <span id="pdf-teacher" class="student-data"></span></td></tr>
            </table>

            <table class="marks-table">
                <thead>
                    <tr>
                        <th>MATA PELAJARAN</th>
                        <th width="15%">MARKAH</th>
                        <th width="15%">GRED</th>
                        <th width="30%">TAHAP PENGUASAAN</th>
                    </tr>
                </thead>
                <tbody id="pdf-marks-body"></tbody>
            </table>

            <div class="summary-box">
                <div>JUMLAH MARKAH: <span id="pdf-total"></span></div>
                <div>PERATUS: <span id="pdf-percent"></span>%</div>
                <div>KEDUDUKAN: <span id="pdf-rank"></span> / <span id="pdf-total-std"></span></div>
            </div>

            <div style="font-weight:bold; font-size:10pt;">ULASAN GURU KELAS:</div>
            <div style="margin-top: 5px; border: 1px solid #000; padding: 10px; min-height: 50px; font-size: 10pt;">
                Tahniah atas usaha anda. Teruskan kecemerlangan dan perbaiki kelemahan di masa hadapan.
            </div>

            <div class="footer-signatures">
                <div class="sig-block"><div class="sig-line"></div><div class="sig-text">Tandatangan Guru Kelas<br>(<span id="pdf-sign-teacher"></span>)</div></div>
                <div class="sig-block"><div class="sig-line"></div><div class="sig-text">Tandatangan Guru Besar<br>SK PULAU PERHENTIAN</div></div>
            </div>

            <div style="text-align: center; margin-top: 20px; font-size: 8pt; color: #555;">
                Dicetak oleh sistem pada: <span id="pdf-date"></span>
            </div>
        </div>
    </div>

    <script>
        // --- DATASET LENGKAP (1M - 6M) ---
        
        const dataRaw = {
            "1M": `
1,ABDUL HADI BIN MOHD ASRI,82,A,80,B,76,B,72,B,70,B,68,B,60,C,82,A,72,B,662
2,AFEEF ZAFRAN BIN ZULALIMI,40,D,50,C,56,C,50,C,64,C,52,C,70,B,60,C,64,C,506
3,ANNUR AFEEFA BINTI MOHAMMAD AJMAIN,90,A,90,A,84,A,82,A,74,B,84,A,75,B,92,A,80,B,751
4,CHE KU QAYYUM BASRIE BIN CIK KU ROZWAN,20,E,36,D,40,D,42,D,0,F,2,F,50,C,52,C,44,D,286
5,FAIQ QAYYUM BIN FAIZOL,30,E,36,D,42,D,38,D,48,D,26,E,60,C,48,D,44,D,372
6,MOHAMAD ADEEL ARYAN BIN MOHAMAD AZMAN,10,F,36,D,36,D,62,C,0,F,24,E,43,D,72,B,TH,G,283
7,MOHAMAD MIZIAN UWAIS AL QARNI BIN FAIZERI,72,B,38,D,36,D,48,D,64,C,18,F,55,C,58,C,TH,G,389
8,MOHAMAD NUDMAN BIN MAZLAN,40,D,38,D,32,E,54,C,58,C,48,D,68,B,64,C,50,C,452
9,MOHAMMAD AFFAN BIN MOHD HAMIZZUL,40,D,40,D,38,D,54,C,76,B,80,B,75,B,64,C,54,C,521
10,MUHAMAD ADAM WAQEEL BIN MOHD KHAIRUL AMIN,56,C,50,C,40,D,66,B,66,B,60,C,43,D,76,B,54,C,511
11,MUHAMAD FAKHRI BIN MOHD IZWAN,40,D,52,C,42,D,18,F,70,B,76,B,40,D,28,E,90,A,456
12,MUHAMMAD AUBREY YASSER BIN MASRON,TH,G,TH,G,TH,G,TH,G,TH,G,TH,G,TH,G,TH,G,TH,G,0
13,MUHAMMAD KHAIZURAN MIRZA BIN MUHAMMAD KASMURI,92,A,96,A,88,A,88,A,72,B,68,B,75,B,98,A,88,A,765
14,MUHAMMAD RAYYAN UKASYAH BIN MULIADI,TH,G,52,C,34,E,40,D,0,F,TH,G,TH,G,50,C,TH,G,176
15,NUR AINAA BATRISYIA BINTI MOHD DAHALAN,30,E,39,D,42,D,42,D,34,E,26,E,73,B,52,C,38,D,376
16,NUR AISY ARISSA BINTI MAHADI,TH,G,TH,G,TH,G,TH,G,0,F,TH,G,TH,G,TH,G,TH,G,0
17,NUR AMANI AAFEEYA BINTI ABDUL HAKIM,90,A,90,A,84,A,78,B,62,C,82,A,100,A,88,A,96,A,770
18,NUR AQEELA NAFEESA BINTI MOHD NURAZMA,TH,G,TH,G,34,E,18,F,0,F,TH,G,TH,G,28,E,TH,G,80
19,NUR AUNI DAFEEYA BINTI MOHAMMAD AIMAN AMIERUL,40,D,40,D,42,D,64,C,56,C,70,C,60,C,74,B,34,E,480
20,NUR AYRA AURELIA BINTI MOHD KHAIRUL AZUAN,80,B,80,B,76,B,68,B,68,B,76,B,70,B,78,B,68,B,664
21,NUR HAIRA RAISHA BINTI KHAIROL AMRI,98,A,96,A,84,A,76,B,88,A,82,A,75,B,86,A,74,B,759
22,NUR INARA BINTI MOHD AZUANDI,50,C,52,C,40,D,84,A,0,F,70,B,90,A,94,A,52,C,532
23,NUR NAURA SYIFA BINTI SHAFIE,90,A,70,B,76,B,78,B,88,A,68,B,53,C,88,A,80,B,691
24,NUR SUFIYYA IZATI BINTI IZAKI,90,A,72,B,74,B,62,C,70,B,84,A,80,B,72,B,76,B,680
25,NUR SYAZIA MALAIKA BINTI SAKRI,20,E,39,D,36,D,34,E,48,D,12,F,53,C,44,D,60,C,346
26,NUR SYIFA NASUHA BINTI ZULKIFLI,82,A,88,A,80,B,78,B,42,D,80,B,63,C,88,A,78,B,679
27,NURUL TIARA SYAHIRA BINTI MUHAIMI,96,A,96,A,82,A,82,A,78,B,80,B,83,A,92,A,76,B,765
28,NUR UMMI SYAHIRA BINTI NOOR HISAM,90,A,90,A,88,A,78,B,84,A,86,A,90,A,88,A,84,A,778
29,PUTRA ANIQ ALIYAN BIN MOHD FADLI,24,E,50,C,62,C,56,C,72,B,64,C,55,C,66,B,42,D,491
30,QUSHAYYI ABBAS BIN ABU ZANGGI,54,C,50,C,60,C,68,B,64,C,82,A,75,B,78,B,TH,G,531
31,RAJA ABBEL EL FATIH BIN RAJA ZULHILMI,24,E,38,D,36,D,40,D,0,F,44,D,40,D,50,C,66,B,338
32,RIZQ ANAQI BIN RAHMAT,26,E,32,E,36,D,34,E,16,F,4,F,40,D,44,D,48,D,280
33,SITI HANA HAURA AISY BINTI ZAINUDIN,20,E,40,D,40,D,42,D,40,D,46,D,55,C,52,C,52,C,387
34,SITI IRFA FILLEA BINTI MOHD IRMIZA,40,D,72,B,74,B,68,B,70,B,54,C,70,B,78,B,66,B,592
35,UMAR FIRASH BIN AMINUDDIN,60,C,50,C,62,C,66,B,60,C,56,B,63,C,76,B,58,C,551
36,WAN NOR QABILLA AURORA BINTI WAN NOR SYAIFUL AZHAM,2,F,14,F,32,E,16,F,14,F,2,F,45,D,26,E,42,D,193`,

            "2M": `
1,ADAM FARHAN BIN ALI SUFIAN,25,E,46,D,34,E,70,B,46,D,89,A,65,C,76,B,85,A,536
2,AMIRA ATIQAH BINTI ADNAN,16,F,30,E,30,E,56,C,12,F,38,D,65,C,46,D,15,F,308
3,HABIB BIN JAPLI,16,F,20,E,28,E,70,B,46,D,35,D,65,C,52,C,15,F,347
4,ISMAIL TALAHA BIN IBRAHIM,P,G,TH,G,X,G,TH,G,TH,G,P,G,TH,G,0,F,0,F,0
5,MOHAMAD NUR HADIF UQAIL BIN MOHD NUR FAIZAL,55,C,52,C,58,C,72,B,46,D,75,B,80,B,78,B,83,A,599
6,MOHAMMAD TAJUL ALEXANDER BIN MOHD AZIZ,32,E,20,E,20,E,42,D,6,F,31,E,60,C,46,D,0,F,257
7,MUHAMMAD AARIZ ZAFRAN BIN MOHD AMAN ZULBILLAH,44,D,20,E,20,E,48,D,40,D,46,D,60,C,62,C,23,E,363
8,MUHAMMAD AFHAM ZAFRAN BIN ZAIRUL AZLI,18,F,20,E,44,D,56,C,20,E,59,C,60,C,46,D,45,D,368
9,MUHAMMAD AFIQ BIN ABDULLAH,20,E,42,D,34,E,60,C,14,F,65,C,55,C,52,C,75,B,417
10,MUHAMMAD AMIN BIN DAZRUL,48,D,22,E,44,D,46,D,46,D,67,B,60,C,62,C,68,B,463
11,MUHAMMAD AZZAM NAUFAL BIN AZRI,18,F,40,D,50,C,68,B,54,C,90,A,65,C,46,D,63,C,494
12,MUHAMMAD FAREEZ HARRAZ BIN BERAHIM @ BAKHORI,24,E,36,D,26,E,46,D,12,F,39,D,60,C,44,D,45,D,332
13,MUHAMMAD FIRMANSHAH INDRA BIN MOHD FARID,20,E,30,E,22,E,30,E,4,F,35,D,65,C,42,D,35,D,283
14,MUHAMMAD HAIKAL BIN DIPAK,22,E,36,D,38,D,24,E,36,D,49,D,60,C,48,D,35,D,348
15,MUHAMMAD IMAN DANIAL BIN NOR CHIK,65,C,76,B,56,C,76,B,62,C,90,A,60,C,82,A,90,A,657
16,MUHAMMAD KHALID AL WALID BIN MOHD ZAKUWAN,20,E,20,E,36,D,54,C,40,D,26,E,55,C,56,C,68,B,375
17,MUHAMMAD LUTH PUTRA AL FATEH BIN SAIFULNIZAM,10,F,10,F,38,D,54,C,8,F,23,E,60,C,40,D,98,A,341
18,MUHAMMAD YUSHAIZAD BIN MOHD YUNUS,40,D,20,E,20,E,20,E,10,F,40,D,TH,G,54,C,0,F,204
19,NEK MUHAMMAD YAASIIN BIN NEK ARIS,42,D,36,D,34,E,50,C,12,F,59,C,65,C,56,C,25,E,379
20,NIK AZIYAD IZZUDDIN BIN NIK ZAMRIFUDIN,28,E,36,D,20,E,60,C,10,F,38,A,60,C,54,C,35,D,341
21,NUR AAMILY SYAFIA BINTI MOHD SANUSI,75,B,52,C,54,C,82,A,20,E,53,C,60,C,76,B,88,A,560
22,NUR AIRA ASHEERA BINTI MOHAMMAD TAUFIK,20,E,20,E,26,E,42,D,20,E,40,D,60,C,44,D,23,E,295
23,NUR ALEESHA BINTI SAKUAN,40,D,52,C,48,D,60,C,16,F,28,E,60,C,52,C,18,F,374
24,NUR MAYA ADNI BINTI HUSSIEN,58,C,52,C,54,C,77,B,40,D,74,B,60,C,78,B,70,B,563
25,NUR ZALIKHA BINTI MUHAMMAD ZAIDI,44,D,76,B,46,D,77,B,18,F,47,D,65,C,56,C,80,B,509
26,RAJA LUTHFI IRSYAD BIN RAJA MOHD HAMZI,50,C,76,B,52,C,76,B,58,C,67,B,65,C,58,C,100,A,602
27,SITI AAISYAH BINTI MOHAMAD IKHWAN,42,D,40,D,40,D,64,C,18,F,43,D,65,C,58,C,0,F,370
28,SITI NUR AZZALEA BINTI AZMAN,94,A,82,A,68,B,98,A,88,A,99,C,80,B,88,A,95,A,792
29,TENGKU HUD ISKANDAR BIN TENGKU HANIF,40,D,80,B,30,E,82,A,50,C,66,B,60,C,54,C,93,A,555
30,WAN MUHAMMAD HAFEEZ ARRIAN BIN WAN MOHD HAFIZIE,24,E,40,D,34,E,68,B,38,D,52,C,65,C,46,D,40,D,407
31,WAN NOR FAEZRUL RAMADHAN BIN WAN NOR HISHAM,52,C,50,C,34,E,72,B,54,C,82,A,80,B,52,C,88,A,564`,

            "3M": `
1,AHMAD FAYYADH PUTRA BIN AHMAD FARIZ,40,D,40,D,40,D,62,C,56,C,58,C,70,B,26,E,18,F,410
2,AMAN DASUQI BIN BURHANUDDIN,80,B,42,D,43,D,58,C,68,B,40,D,55,C,64,C,42,D,492
3,CIK KU QAIRISYIA HUSNA BINTI CIK KU ROZWAN,85,A,42,D,40,D,54,C,40,D,38,D,60,C,48,D,54,C,461
4,INDAH DHIA EDRIANA BINTI ALIMIN,88,A,66,B,47,D,66,B,82,A,80,B,70,B,40,D,66,B,605
5,IZARIEL ARJUNA BIN AERIZOL,60,C,42,D,20,E,48,D,56,C,57,C,65,C,30,E,50,C,428
6,MOHAMMAD AIDIL NAUFAL BIN MOHD NURAZMA,53,C,50,C,23,E,60,C,66,B,53,C,60,C,46,D,28,E,439
7,MUHAMAD FIRAS AMSYAR BIN MUHAMAD IZZAT,18,F,38,D,20,E,40,D,50,C,49,D,60,C,28,E,28,E,331
8,MUHAMMAD AIMAN MUZIDAN BIN MUHAMMAD HASMIZAM,33,E,38,D,20,E,48,D,74,B,33,E,60,C,28,E,28,E,362
9,MUHAMMAD ANAQI HAIKAL BIN MOHD ERUWAN,88,A,70,B,60,C,76,B,66,B,72,B,60,C,74,B,62,C,628
10,MUHAMMAD HARRAZ NAUFAL BIN MUHAMAD HANAFI,80,B,70,B,47,D,68,B,56,C,68,B,60,C,38,D,58,C,545
11,MUHAMMAD HAZIM MUKHRIZ BIN MOHD HAZIMAZUDIN,73,B,40,D,40,D,54,C,58,C,43,D,60,C,30,E,22,E,420
12,MUHAMMAD IZZ RAYYAN BIN MOHD ZULKIFLY,55,C,36,D,27,E,42,D,66,B,47,D,60,C,34,E,46,D,413
13,MUHAMMAD KHALIF RIDHWAN BIN MOHD KASMAN,88,A,66,B,37,D,74,B,56,C,82,A,55,C,42,D,66,B,566
14,MUHAMMAD NAUFAL AMSYAR BIN MOHD SYAHRIL,80,B,52,C,73,B,50,C,60,C,64,C,60,C,30,E,52,C,521
15,MUHAMMAD SYAHID NAQIB BIN MOHD SYAKIRAN,43,D,32,E,20,E,30,E,62,C,36,D,50,C,14,F,42,D,329
16,MUHAMMAD TAUFIQ BIN MOHD TAZUDDIN,28,E,32,E,20,E,42,D,62,C,10,F,40,D,12,F,32,E,278
17,MUHAMMAD ZIYAD LUTHFI BIN MOHD NOOR AZMI,88,A,50,C,57,C,84,A,80,B,78,B,60,C,66,B,68,B,631
18,NAYLA RASYIQAH BINTI SAMSU,80,B,40,D,23,E,54,C,60,C,38,D,70,B,46,D,36,D,447
19,NIK AYUMI BASYIRA BINTI NIK ZAWAWI,80,B,24,E,23,E,54,C,60,C,48,C,60,C,64,C,44,D,457
20,NIK MOHAMMAD AMSYAR BIN NIK MUHAMMAD,0,F,24,E,23,E,34,E,50,C,34,D,40,D,12,F,38,D,255
21,NOR IFFAH AMANINA BINTI MOHD ERIZOL,93,A,82,A,60,C,58,C,60,C,86,A,80,B,80,B,60,C,659
22,NUR AIN UMAIRAH BINTI ROSMARAZI,95,A,46,D,20,E,68,B,54,C,54,C,60,C,38,D,56,C,491
23,NUR ANIS QAISYARA BINTI AILI @ GHAZALI,80,B,46,D,20,E,50,C,40,D,30,E,60,C,32,E,48,D,406
24,NUR ARIQA FATINA BINTI FARKIRA,40,D,46,D,10,F,44,D,50,C,59,C,60,C,32,E,20,E,361
25,NUR ARMEL DIANDRA BINTI AZWI,83,A,84,A,67,B,76,B,64,C,69,B,70,B,64,C,82,A,659
26,NURHANA RAISYA BINTI MOHD RAIME IZANE,TH,G,TH,G,0,F,TH,G,TH,G,P,G,TH,G,TH,G,P,G,0
27,NUR IRDINA AMMARA BINTI MOHAMAD NAZMI,75,B,84,A,33,E,80,B,58,C,64,C,60,C,50,C,44,D,548
28,NURSYAMIMI AZIA BINTI MOHAMAD SADERI,88,A,42,D,33,E,52,C,56,C,60,C,60,C,12,F,30,E,433
29,NUR SYIFA ELYSIA BINTI CHE ZALMI,83,A,42,D,47,D,48,D,40,D,42,D,60,C,30,E,40,D,432
30,PUTRI ANGGUN FATHIA BINTI AHMAD FAIZ,30,E,40,D,43,D,60,C,56,C,72,B,60,C,22,E,40,D,423
31,SITI NUR AISYA ZAHRA BINTI MOHD ASOHAN,75,B,54,C,50,C,64,C,54,C,56,C,65,C,20,E,42,D,480
32,WAN NUR AISYAH HUMAIRA BINTI WAN MUHAMAD SHAFAREZ,30,E,32,E,23,E,32,E,30,E,37,D,55,C,22,E,36,D,297`,

            "4M": `
1,ABDUL AZIZ BIN MOHD ASRI,74,B,30,E,50,C,44,D,42,D,38,D,48,D,86,A,50,C,58,C,50,C,570
2,AHMAD YUSRIN FIRDAUS BIN MUHAMAD AFIZI,68,B,30,E,68,B,48,D,76,B,44,D,44,D,70,B,60,C,62,C,66,B,636
3,AMIRA ALEESYA BINTI ADNAN,54,C,24,E,42,D,56,C,54,C,40,D,54,C,67,B,32,E,44,D,66,B,533
4,DIAN IRDINA DELISHA BINTI MUHAMAD RAZALI,42,D,34,E,32,E,42,D,56,C,36,D,30,E,82,A,42,D,46,D,74,B,516
5,IRIS UQASYA BINTI AZWAN,52,C,52,C,70,B,50,C,0,F,72,B,46,D,75,B,50,C,44,D,66,B,577
6,MOHAMAD FIRDAUS BIN MOHAMAD FAIZUDIN,46,D,26,E,36,D,50,C,58,C,68,B,60,C,82,A,54,C,36,D,46,D,562
7,MOHAMAD HARIZZKI BIN ZAINUDIN,46,D,20,E,32,E,50,C,42,D,30,E,42,D,64,C,48,D,50,C,60,C,484
8,MOHAMAD SHARIM AMZAR BIN ZULKIFLI,30,E,36,D,30,E,50,C,44,D,48,D,50,C,82,A,48,D,48,D,54,C,520
9,MOHAMMAD ZARIQ ARYAN BIN MOHD AMIRUL HAFIZ,30,E,22,E,24,E,46,D,76,B,80,B,42,D,66,B,52,C,32,E,62,C,532
10,MUHAMMAD DARIS MIKHAEL BIN MEKHAZAENIKA,8,F,10,F,26,E,48,D,38,D,24,E,40,D,61,C,20,E,12,F,10,F,297
11,MUHAMMAD HAIRULMUNIRRIZQI BIN HALIM,6,F,20,E,32,E,38,D,42,D,40,D,44,D,61,C,20,E,18,F,20,E,341
12,MUHAMMAD KHAIRI HABIBULLAH BIN MUHAMMAD KASMURI,30,E,12,F,30,E,60,C,74,B,80,B,54,C,66,B,44,D,42,D,56,C,548
13,MUHAMMAD RAFFIQ HAMSYAR BIN MUHAMAD ZAWADI,42,D,18,F,40,D,56,C,46,D,38,D,40,D,70,B,54,C,46,D,62,C,512
14,MUHAMMAD RIFQI AMINUDDIN BIN MOHD RIZZAL,30,E,12,F,34,E,44,D,56,C,58,C,24,E,82,A,40,D,30,E,52,C,462
15,MUHAMMAD SUDAIS BIN AZWANIZAN,42,D,24,E,48,D,60,C,58,C,44,D,42,D,74,B,42,D,44,D,64,C,542
16,MUHAMMAD ZAHIN IRFAN BIN MOHD INSANUSI,48,D,42,D,42,D,50,C,62,C,58,C,52,C,66,B,52,C,52,C,68,B,592
17,NIK NUR ARIQA FATHINA BINTI NIK HARON,50,C,36,D,68,B,60,C,54,C,62,C,46,D,75,B,48,D,46,D,54,C,599
18,NUR AMEERA DELISHA BINTI ASMA DIZAM,66,B,56,C,70,B,66,B,93,A,72,B,44,D,82,A,54,C,54,C,66,B,723
19,NUR AMIRA BINTI NIK KOB,30,E,18,F,32,E,40,D,38,D,58,C,30,E,72,B,24,E,28,E,32,E,402
20,NUR ANISSA ZAHRA BINTI ENCIK MOHD GHAZALI,28,E,14,F,30,E,50,C,46,D,60,C,56,C,82,A,50,C,42,D,40,D,498
21,NUR AUNI SAFFIYA BINTI MOHD AMAN ZULBILLAH,14,F,16,F,28,E,40,D,46,D,48,D,46,D,85,A,44,D,16,F,60,C,443
22,NURIN SYUHADA KAMELIA BINTI MAHADI,42,D,26,E,52,C,54,C,36,D,58,C,52,C,66,B,46,D,50,C,58,C,540
23,NURUL NUR NILAM SARIEY BINTI ABDULLAH,16,F,14,F,28,E,38,D,0,F,0,F,40,D,67,B,62,C,30,E,42,D,337
24,PUTERI KHAYLA ALYSSA BINTI MOHD FADLI,26,E,20,E,22,E,42,D,36,D,40,D,40,C,75,B,26,E,30,E,50,C,417
25,PUTRI AMMAYA KHAIRIN BINTI MUHAMAD ALIF,44,D,30,E,50,C,46,D,46,D,36,D,46,E,84,A,36,D,40,D,50,C,494
26,PUTRI ERNIA RAMADHANI BINTI MOHD FITRI,36,D,16,F,42,D,46,D,58,C,32,E,46,D,70,B,44,D,42,D,58,C,490
27,RAJA NUR AMMARA AISYAH BINTI RAJA ZULHILMI,40,D,14,F,40,D,46,D,46,D,0,F,50,C,85,A,34,E,50,C,42,D,447
28,SITI IRFA FATHIA BINTI MOHD IRMIZA,44,D,30,E,42,D,44,D,50,C,52,C,32,E,76,B,64,C,32,E,48,D,514`,

            "5M": `
1,DANIAL THAQIF BIN MOHD FADLI,42,D,30,E,30,E,75,B,54,C,30,E,73,B,88,A,54,C,70,B,50,C,596
2,IZZUL IKHWAN BIN HASHIM,14,F,14,F,24,E,32,E,34,E,36,D,36,D,65,C,38,D,40,D,30,E,363
3,KARL ISKANDAR FAKHRULLAH BIN MOHD KHAIRUL AZUAN,50,C,30,E,48,D,42,D,62,C,52,C,58,C,70,B,46,D,63,C,64,C,585
4,MANJA NUR AS SYIFA BINTI MOHD SAZMIEZUL,22,E,76,B,22,E,46,D,34,E,38,D,34,E,62,C,42,D,22,E,46,D,444
5,MOHAMAD ALIFF AL AMIEE BIN ABDULLAH,28,E,30,E,36,D,54,C,46,D,38,D,44,D,66,B,64,C,12,F,46,D,464
6,MUHAMMAD ADAM BASRI BIN MOHD IZWAN,54,C,10,F,46,D,64,C,60,C,36,D,54,C,74,B,68,B,26,E,48,D,540
7,MUHAMMAD ADAM FAHMI BIN SUHAIMI,22,E,24,E,48,D,32,E,48,D,50,C,42,D,68,B,62,C,22,E,44,D,462
8,MUHAMMAD AIRIL DARWISY BIN MOHAMMAD AIMAN AMIERUL,30,E,32,E,30,E,36,D,56,C,48,D,18,F,68,B,58,C,46,D,36,D,458
9,MUHAMMAD ARSYAD AMIN BIN MOHAMED,18,F,28,E,22,E,24,E,52,C,46,D,40,D,64,C,46,D,22,E,38,D,400
10,MUHAMMAD FATRIA ARSHAD BIN MOHD ERIZOL,44,D,26,E,52,C,32,E,52,C,48,D,50,C,67,B,42,D,20,E,60,C,493
11,MUHAMMAD HABIBULLAH BIN MOHAMMAD HANAFI,24,E,10,F,34,E,40,D,44,D,46,D,0,F,68,B,62,C,46,D,TH,#N/A,374
12,MUHAMMAD HAZIM ZULFAQAR BIN MOHD HAZIMAZUDIN,34,E,16,F,44,D,28,E,34,E,28,E,44,D,67,B,52,C,26,E,64,C,437
13,MUHAMMAD HAZIQ ABRISAM BIN MOHD ANIS,34,E,16,F,68,B,46,D,92,A,58,C,46,D,68,B,56,C,36,D,56,C,576
14,MUHAMMAD MUJAHIDDEEN BIN MOHD ZAKUWAN,26,E,22,E,44,D,50,C,40,D,46,D,52,C,70,B,48,D,60,C,70,B,528
15,MUHAMMAD SYAFIQ AMSYAR BIN SAMI'ON,72,B,40,D,76,B,70,B,62,C,60,C,54,C,71,B,72,B,60,C,48,D,685
16,NIK AISY RAYYAN SAIFULLAH BIN NIK AZIZAN,42,D,22,E,36,D,52,C,58,C,52,C,60,C,66,B,70,B,28,E,46,D,532
17,NIK AMMER FARHAN BIN NIK HARON,64,C,34,E,66,B,40,D,72,B,62,C,60,C,70,B,58,C,60,C,58,C,644
18,NUR ADNIN BINTI DAZRUL,14,F,32,E,38,D,44,D,52,C,42,D,46,D,68,B,52,C,22,E,38,D,448
19,NUR AIN AZZAHRA BINTI ZULALIMI,42,D,30,E,38,D,50,C,54,C,54,C,56,C,68,B,52,C,48,D,38,D,530
20,NUR AWATIF BINTI MASRON,16,F,0,F,38,D,40,D,46,D,34,E,0,F,66,B,,F,40,D,TH,#N/A,280
21,NUR DAHLIA MADENA BINTI FAIZERI,24,E,20,E,28,E,40,D,40,D,50,C,50,C,66,B,64,C,16,F,40,D,438
22,NUR DINIE SOFIA BINTI NOR CHIK,74,B,74,B,42,D,62,C,97,A,98,A,54,C,68,B,72,B,65,C,64,C,770
23,NUR HANNA ARISYA BINTI MOHD AZUAN AFENDI,22,E,12,F,40,D,40,D,48,D,24,E,36,D,62,C,68,B,32,E,28,E,412
24,NUR LAILATUL ADAWIYAH BINTI MOHD.SUHAILI,46,D,42,D,46,D,65,C,84,A,72,B,58,C,68,B,52,C,53,C,48,D,634
25,NUR ZHAAFIRAH BINTI ZAMRI,64,C,46,D,74,B,61,C,91,A,82,A,60,C,70,B,56,C,50,C,52,C,706
26,PUTRA AMMAR DANI BIN MOHD FARID,22,E,12,F,48,D,30,E,56,C,36,D,40,D,66,B,50,C,26,E,36,D,422
27,PUTRI AMANDA KHAYLA BINTI MUHAMAD ALIF,20,E,22,E,44,D,46,D,56,C,50,C,32,E,62,C,58,C,40,D,54,C,484
28,SYED ALI SAGAFF BIN SYED MUHAMED SHARER,54,C,40,D,34,E,62,C,93,A,30,E,48,D,70,B,66,B,52,C,58,C,607
29,WAN HALIMATUS SAADIAH BINTI WAN ISLAHUDIN,56,C,52,C,50,C,50,C,92,A,62,C,48,D,70,B,54,C,63,C,60,C,657`,

            "6M": `
1,CHE JUELIYA AFIFAH BINTI CHE AZIZ,50,C,10,F,36,D,50,C,56,C,40,D,46,D,54,C,66,B,36,D,50,C,494
2,MOHAMAD SYAHID AIZRIL BIN MOHAMAD SADERI,20,E,12,F,32,E,46,D,40,D,30,E,28,E,42,D,64,C,22,E,36,D,372
3,MUHAMMAD AIRIQ DARWISH BIN MOHAMMAD AIMAN AMIERUL,60,C,10,F,34,E,40,D,54,C,36,D,50,C,56,C,70,B,38,D,40,D,488
4,MUHAMMAD AMMAR ZIKRY BIN RIZAL,TH,#N/A,,F,TH,#N/A,TH,#N/A,TH,#N/A,TH,#N/A,0,F,0,F,TH,#N/A,TH,#N/A,TH,#N/A,0
5,MUHAMMAD ARFA SYAHIRAN BIN ZAIRUL AZLI,30,E,12,F,32,E,40,D,42,D,30,E,34,E,40,D,68,B,36,D,50,C,414
6,MUHAMMAD HARITH RAYKAL BIN KHAIROL AMRI,70,B,30,E,84,A,56,C,68,B,74,B,62,C,58,C,72,B,50,C,46,D,670
7,MUHAMMAD IRSYAD ADLAN BIN SHAARI,46,D,16,F,76,B,56,C,50,C,66,B,60,C,80,B,84,A,48,D,54,C,636
8,MUHAMMAD LUQMANUL LUTFI BIN MOHD AMIROL ASUAN,78,B,18,F,38,D,62,C,52,C,76,B,72,B,82,A,88,A,52,C,60,C,678
9,MUHAMMAD MUQREY RAFIQIE BIN ZULKIFLI,40,D,18,F,74,B,52,C,66,B,68,B,52,C,72,B,78,B,40,D,46,D,606
10,MUHAMMAD RAFIQ ASYRAAF BIN RAHMAT,46,D,10,F,38,D,52,C,56,C,58,C,44,D,58,C,64,C,24,E,52,C,502
11,NEK NUR AINUL SUMAYYAH BINTI NEK ARIS,48,D,32,E,50,C,44,D,72,B,62,C,64,C,48,D,62,C,56,C,46,D,584
12,NIK ARIF BAIHAQI BIN NIK ZAWAWI,50,C,28,E,42,D,60,C,50,C,42,D,36,D,54,C,58,C,32,E,56,C,508
13,NIK RABIATUL ADAWIYAH BINTI NIK MOHD RIZUAN,70,B,34,E,34,E,54,C,68,B,72,B,60,C,58,C,80,B,42,D,54,C,626
14,NUR AFZA BATRISYIA BINTI MUHAMAD,48,D,16,F,38,D,48,D,40,D,52,C,60,C,38,D,76,B,26,E,60,C,502
15,NUR AISY AZZALEA BINTI MOHD AZUANDI,36,D,20,E,34,E,40,D,72,B,54,C,64,C,42,D,80,B,46,D,50,C,538
16,NUR AMANDA SUFI BINTI MOHD SANUSI,86,A,52,C,50,C,48,D,80,B,66,B,72,B,76,B,68,B,66,B,60,C,724
17,NUR AUNI BATRISYIA BINTI MOHD DAHALAN,40,D,26,E,42,D,44,D,40,D,70,B,44,D,58,C,78,B,50,C,56,C,548
18,NUR DELISHA QAISARA BINTI ALI SUFIAN,70,B,40,D,66,B,54,C,68,B,78,B,60,C,74,B,86,A,46,D,56,C,698
19,NUR EZZARA IRLAIKHA BINTI HAZRIN,24,E,24,E,34,E,40,D,48,D,60,C,36,D,42,D,40,D,24,E,50,C,422
20,NUR SYIFAA QAISARA BINTI SAKRI,32,E,20,E,46,D,50,C,50,C,32,E,56,C,44,D,68,B,36,D,60,C,494
21,NURUL ADILLA BINTI MUHAMMAD ADAM,86,A,46,D,72,B,72,B,66,B,70,B,68,B,48,D,82,A,44,D,66,B,720
22,NURUL IMAN DAMIA BINTI NORHISHAM,22,E,24,E,36,D,44,D,50,C,26,E,52,C,48,D,72,B,28,E,50,C,452
23,NURUL QURRATU' AINI BINTI YUSOF,84,A,50,C,48,D,52,C,70,B,72,B,66,B,60,C,76,B,58,C,64,C,700
24,PUTRI AIRISS FARINA BINTI AHMAD FAIZ,64,C,24,E,38,D,60,C,78,B,62,C,72,B,62,C,54,C,30,E,46,D,590
25,QAISH PUTRA AL AMILIEY BIN SAIFULNIZAM,48,D,16,F,38,D,32,E,40,D,32,E,38,D,40,D,72,B,12,F,50,C,418
26,SITI SYAMIRA SUPIA BINTI DAHLAN ZAINUDDIN,42,D,20,E,34,E,52,C,50,C,38,D,54,C,38,D,68,B,28,E,56,C,480`
        };

        const classTeachers = {
            "1M": "USTAZAH RAFIDA",
            "2M": "SIR HAFIEZ HAKIMIE",
            "3M": "USTAZAH AEN",
            "4M": "CIKGU HASNIDA",
            "5M": "SIR AKIF SYAHMI",
            "6M": "EN BAHAROM"
        };

        const subjectsLower = [
            { name: "BAHASA MELAYU", code: "BM" },
            { name: "BAHASA INGGERIS", code: "BI" },
            { name: "MATEMATIK", code: "MT" },
            { name: "SAINS", code: "SAINS" },
            { name: "PENDIDIKAN ISLAM", code: "PI" },
            { name: "BAHASA ARAB", code: "BA" },
            { name: "PENDIDIKAN SENI VISUAL", code: "PSV" },
            { name: "PJK", code: "PJK" },
            { name: "MUZIK", code: "MZ" }
        ];

        const subjectsUpper = [
            ...subjectsLower,
            { name: "SEJARAH", code: "SEJ" },
            { name: "REKA BENTUK TEKNOLOGI", code: "RBT" }
        ];

        let studentsData = [];

        function parseCSV() {
            Object.keys(dataRaw).forEach(cls => {
                const lines = dataRaw[cls].trim().split('\n');
                const isUpper = ['4M', '5M', '6M'].includes(cls);
                const subjects = isUpper ? subjectsUpper : subjectsLower;

                lines.forEach(line => {
                    if(!line.trim()) return;
                    const cols = line.split(',');
                    if(isNaN(parseInt(cols[0]))) return;

                    let student = {
                        id: cols[0],
                        name: cols[1],
                        class: cls,
                        teacher: classTeachers[cls],
                        marks: [],
                        total: 0
                    };

                    let colIndex = 2;
                    subjects.forEach(subj => {
                        let mRaw = cols[colIndex];
                        let gRaw = cols[colIndex+1];
                        
                        let mark = (mRaw === 'TH' || mRaw === 'X' || mRaw === '' || mRaw === undefined) ? 0 : parseInt(mRaw);
                        if(isNaN(mark)) mark = 0;
                        
                        let grade = (gRaw === undefined || gRaw === '') ? 'TH' : gRaw.replace('#N/A', 'TH').replace('G', 'TH');
                        if(mRaw === 'TH') grade = 'TH';

                        student.marks.push({
                            subject: subj.name,
                            code: subj.code,
                            val: mark,
                            grade: grade
                        });
                        student.total += mark;
                        colIndex += 2;
                    });

                    studentsData.push(student);
                });
            });

            // Ranking
            const classes = ['1M', '2M', '3M', '4M', '5M', '6M'];
            classes.forEach(c => {
                let classStudents = studentsData.filter(s => s.class === c);
                classStudents.sort((a, b) => b.total - a.total);
                classStudents.forEach((s, index) => {
                    s.rank = index + 1;
                    s.totalStudents = classStudents.length;
                });
            });
        }

        // Logic Carian Ibu Bapa
        function findStudent() {
            const query = document.getElementById('parent-input').value.toLowerCase().trim();
            const resultDiv = document.getElementById('result-section');
            resultDiv.innerHTML = "";
            resultDiv.style.display = "block";

            if(query.length < 3) {
                resultDiv.innerHTML = `<div class="no-result">Sila masukkan sekurang-kurangnya 3 huruf.</div>`;
                return;
            }

            const filtered = studentsData.filter(s => s.name.toLowerCase().includes(query));

            if(filtered.length === 0) {
                resultDiv.innerHTML = `<div class="no-result">Maaf, tiada rekod dijumpai untuk carian '${query}'.<br>Sila cuba ejaan lain.</div>`;
                return;
            }

            let html = '<ul class="student-list">';
            filtered.forEach(s => {
                const maxMarks = s.marks.length * 100;
                const perc = (s.total / maxMarks * 100).toFixed(2);
                
                html += `
                    <li class="student-card">
                        <div class="st-info">
                            <h3>${s.name}</h3>
                            <p><strong>KELAS:</strong> ${s.class}</p>
                            <p><strong>KEDUDUKAN:</strong> ${s.rank} / ${s.totalStudents}</p>
                        </div>
                        <button class="action-btn" onclick="generatePDF('${s.name}')">
                            ðŸ“¥ Muat Turun Slip
                        </button>
                    </li>
                `;
            });
            html += '</ul>';
            resultDiv.innerHTML = html;
        }

        function generatePDF(studentName) {
            const s = studentsData.find(st => st.name === studentName);
            if(!s) return;

            alert("Sedang menjana slip keputusan untuk " + s.name + ". Sila tunggu...");

            document.getElementById('pdf-name').innerText = s.name;
            document.getElementById('pdf-class').innerText = "TAHUN " + s.class;
            document.getElementById('pdf-teacher').innerText = s.teacher;
            document.getElementById('pdf-sign-teacher').innerText = s.teacher;
            document.getElementById('pdf-date').innerText = new Date().toLocaleDateString('ms-MY');

            const tbody = document.getElementById('pdf-marks-body');
            tbody.innerHTML = '';

            s.marks.forEach(m => {
                let tp = "-";
                if(m.grade === 'A') tp = "TAHAP 6 (CEMERLANG)";
                else if(m.grade === 'B') tp = "TAHAP 5 (BAIK)";
                else if(m.grade === 'C') tp = "TAHAP 4 (MEMUASKAN)";
                else if(m.grade === 'D') tp = "TAHAP 3 (MENCAPAI)";
                else if(m.grade === 'E') tp = "TAHAP 2 (BELUM MENCAPAI)";
                else if(m.grade === 'F') tp = "TAHAP 1 (PERLU BIMBINGAN)";
                else tp = "TIDAK HADIR";

                tbody.innerHTML += `
                    <tr>
                        <td>${m.subject}</td>
                        <td>${m.val}</td>
                        <td>${m.grade}</td>
                        <td>${tp}</td>
                    </tr>
                `;
            });

            const maxMarks = s.marks.length * 100;
            const perc = (s.total / maxMarks * 100).toFixed(2);

            document.getElementById('pdf-total').innerText = s.total + " / " + maxMarks;
            document.getElementById('pdf-percent').innerText = perc;
            document.getElementById('pdf-rank').innerText = s.rank;
            document.getElementById('pdf-total-std').innerText = s.totalStudents;

            const element = document.getElementById('slip-container');
            const opt = {
                margin:       0,
                filename:     `Slip_Keputusan_${s.name.replace(/\s+/g, '_')}.pdf`,
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true, scrollY: 0 },
                jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' }
            };

            html2pdf().set(opt).from(element).save();
        }

        // Init
        parseCSV();

    </script>
</body>
</html>
